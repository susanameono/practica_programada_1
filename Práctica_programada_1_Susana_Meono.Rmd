---
title: 'Práctica programada 1: Preparación y limpieza de datos'
author: "Susana Meoño Piedra"
date: "2023-07-02"
output: html_document
---

a. Cree un archivo Rmarkdown para resolver esta práctica programada. En el chunk de setup cargue las librerías que considere necesarias para resolver la práctica. Los datos para trabajar puede cargarlos con la función read_csv2 de readr directamente de la siguiente dirección: “https://raw.githubusercontent.com/isa229/programacion_analisis_datos_ii/main/netflix_info.csv” (1pto)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(datasets)
library(datos)
library(ggplot2)
library(readr) #lectura y carga de datos
library(readxl)
library(tidyr)# doma de datos
library(janitor) #limpieza de datos
library(lubridate)
library(hms)
library(stringr)
```

Carga de los datos:

```{r}
datos_shows <- read_csv2("https://raw.githubusercontent.com/isa229/programacion_analisis_datos_ii/main/netflix_info.csv") 
View(datos_shows)

```

b. Ajuste los nombres de las columnas para que estén en español. (2pts)

```{r}
glimpse(datos_shows)
columnas_espanol <- datos_shows |>
  rename("ID_de_show" = "show_id",
         "Tipo" = "type",
         "Título" = "title",
         "Director" = "director",
         "País" = "country",
         "Fecha_añadida"= "date_added",
         "Año_estreno" = "release_year",
         "Puntuación" = "rating",
         "Duración" = "duration",
         "Incluido_en" = "listed_in",
         )
clean_names(columnas_espanol)
View(columnas_espanol)
```


c. Elimine filas duplicadas. (2pts)

```{r}
filas_duplicadas <- columnas_espanol |> 
  janitor::get_dupes()
```

Hay 21 filas duplicadas en total, que tienen al menos un duplicado. Esta es la lista de las filas con duplicados:

```{r}
#para que no se vean valores repetidos se aplica distinct:
filas_distintas_duplicadas <- filas_duplicadas |> 
  distinct()
```

Para eliminar las filas duplicadas hacemos un distinct() de los datos en español:

```{r}
datos_shows_limpio <- columnas_espanol |> 
  distinct()

#Pasamos de tener 8804 filas inicialmente, a tener 8791 filas, luego de eliminar las duplicadas.
```


d. Elimine filas y columnas vacías. (2pts)

```{r}
datos_sin_vacios <- datos_shows_limpio |> 
  remove_empty(which = c("rows", "cols")) # remueve filas y columnas vacías

# ahora tenemos 8790 filas, es decir, se eliminó 1 fila que estaba vacía. No se eliminó ninguna columna.
```


e. Elimine la variable correspondiente al año de lanzamiento (release_year.) (2pts)

```{r}
datos_sin_lanzamiento <- datos_sin_vacios |> 
  select(-Año_estreno) |> 
  distinct()
```


f. Haga una inspección de las variables type y country para determinar si hay observaciones mal escritas o escritas de diferentes maneras. Si es ahí, haga la limpieza para poder homogenizar esos datos. (10pts)

```{r}
# Inspeccionamos primero la columna de "Tipo":

inspeccion_tipo  <- datos_sin_lanzamiento |>
  distinct(Tipo)
View(inspeccion_tipo)
glimpse(inspeccion_tipo)

# vemos que hay valores duplicados que están mal escritos: "tv show", "movie", "Movi", entonces los vamos a homogenizar para que solamente queden dos posibles valores: "Movie" y "TV Show"
```

```{r}
#Homogenización de la columna "Tipo":
tipos_shows <- datos_sin_lanzamiento |> 
  mutate(Tipo = case_when(Tipo == "tv show" ~ "TV Show",
                                       Tipo %in% c("movie", "Movi") ~ "Movie",
                                       TRUE ~ Tipo 
                                       ))
tipos_distintos <- tipos_shows |>
distinct(Tipo)
View(tipos_distintos)
```


```{r}
# Luego inspeccionamos la columna de "País":

inspeccion_pais  <- tipos_shows |>
  distinct(País)
View(inspeccion_pais)
glimpse(inspeccion_pais)

# vemos que hay valores duplicados que están mal escritos: "united states", "United State", "pakistan", "india", "canada", 
#entonces los vamos a homogenizar para que solamente queden los nombres correctos: "United States", "India", "Pakistan", "Canada".
```

```{r}
#Homogenización de la columna "País":
paises_shows <- tipos_shows |> 
  mutate(País = case_when(País == "canada" ~ "Canada",
                          País == "pakistan" ~ "Pakistan",
                          País == "india" ~ "India",
                          País == "West Germany" ~ "Germany",
                                       País %in% c("united states", "United State") ~ "United States",
                                       TRUE ~ País 
                                       ))
paises_distintos <- paises_shows |>
distinct(País)
View(paises_distintos)
```

